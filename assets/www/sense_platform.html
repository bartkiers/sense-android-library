<!DOCTYPE HTML>
<html>
    <head>
        <!-- <meta name="viewport" content="width=320; user-scalable=no" /> -->
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <title>PhoneGap</title>
        <link rel="stylesheet" href="master.css" type="text/css" media="screen" title="no title" charset="utf-8">
        <script type="text/javascript" charset="utf-8" src="cordova-1.5.0.js"></script>
        <script type="text/javascript" charset="utf-8" src="md5.js"></script>
        <script type="text/javascript" charset="utf-8" src="sense_platform.js"></script>
        <script type="text/javascript">
        function onLoad() {
            // console.log('page loaded');
            document.addEventListener('deviceready', onDeviceReady, false);
        };
        function onDeviceReady() {
            // console.log('phonegap ready');
            window.plugins.sense.init();
        };
        function onLoginClick() {
            window.plugins.sense.changeLogin('foo', MD5('bar'),
                    function(r) {
                       alert('Login complete. Result: ' + r);
                    },
                    function(e) {
                        alert('changeLogin(\'foo\', \'' + MD5('bar') + '\') error: ' + e);
                    }
                );
        };
        function onLogoutClick() {
            window.plugins.sense.logout(
                    function(r) {
                        alert('Logout complete. Result: ' + r);
                    },
                    function(e) {
                        alert('logout() error: ' + e);
                    }
                );
        };
        function onRegisterClick() {
            window.plugins.sense.register('username', 'password', 'password', 'surname', 'email@example.com', '+3112345678',
                    function(r) {
                        alert('Register complete. Result: ' + r);
                    },
                    function(e) {
                        alert('register() error: ' + e);
                    }
                );
        };
        function onStartSensingClick() {
            window.plugins.sense.toggleMain(true,
                    function(r) {
                        alert('Start sensing complete. Result: ' + r);
                    },
                    function(e) {
                        alert('toggleMain(true) error: ' + e);
                    }
                );
        };
        function onStopSensingClick() {
            window.plugins.sense.toggleMain(false,
                    function(r) {
                        alert('Stop sensing complete. Result: ' + r);
                    },
                    function(e) {
                        alert('toggleMain(false) error: ' + e);
                    }
                );
        };
        function onSampleClick(rate) {
            window.plugins.sense.setPref(SensePlatform.PREF_SAMPLE_RATE, rate);
        };
        function onSyncClick(rate) {
            window.plugins.sense.setPref(SensePlatform.PREF_SYNC_RATE, rate);
        };
        function onStartPhoneStateClick() {
            window.plugins.sense.togglePhoneState(true,
                    function(r) {
                        alert('togglePhoneState(true) result: ' + r);
                    },
                    function(e) {
                        alert('togglePhoneState(true) error: ' + e);
                    }
                );
        };
        function onStopPhoneStateClick() {
            window.plugins.sense.togglePhoneState(false,
                    function(r) {
                        alert('togglePhoneState(false) result: ' + r);
                    },
                    function(e) {
                        alert('togglePhoneState(false) error: ' + e);
                    }
                );
        };
        function onStartPositionClick() {
            window.plugins.sense.togglePosition(true,
                    function(r) {
                        alert('togglePosition(true) result: ' + r);
                    },
                    function(e) {
                        alert('togglePosition(true) error: ' + e);
                    }
                );
        };
        function onStopPositionClick() {
            window.plugins.sense.togglePosition(false,
                    function(r) {
                        alert('togglePosition(false) result: ' + r);
                    },
                    function(e) {
                        alert('togglePosition(false) error: ' + e);
                    }
                );
        };
        function onStartAmbienceClick() {
            window.plugins.sense.toggleAmbience(true,
                    function(r) {
                        alert('toggleAmbience(true) result: ' + r);
                    },
                    function(e) {
                        alert('toggleAmbience(true) error: ' + e);
                    }
                );
        };
        function onStopAmbienceClick() {
            window.plugins.sense.toggleAmbience(false,
                    function(r) {
                        alert('toggleAmbience(false) result: ' + r);
                    },
                    function(e) {
                        alert('toggleAmbience(false) error: ' + e);
                    }
                );
        };
        function onStartMotionClick() {
            window.plugins.sense.toggleMotion(true,
                    function(r) {
                        alert('toggleMotion(true) result: ' + r);
                    },
                    function(e) {
                        alert('toggleMotion(true) error: ' + e);
                    }
                );
        };
        function onStopMotionClick() {
            window.plugins.sense.toggleMotion(false,
                    function(r) {
                        alert('toggleMotion(false) result: ' + r);
                    },
                    function(e) {
                        alert('toggleMotion(false) error: ' + e);
                    }
                );
        };
        function onStartNeighDevClick() {
            window.plugins.sense.toggleNeighDev(true,
                    function(r) {
                        alert('toggleNeighDev(true) result: ' + r);
                    },
                    function(e) {
                        alert('toggleNeighDev(true) error: ' + e);
                    }
                );
        };
        function onStopNeighDevClick() {
            window.plugins.sense.toggleNeighDev(false,
                    function(r) {
                        alert('toggleNeighDev(false) result: ' + r);
                    },
                    function(e) {
                        alert('toggleNeighDev(false) error: ' + e);
                    }
                );
        };
        function onStartExternalClick() {
            window.plugins.sense.toggleExternal(true,
                    function(r) {
                        alert('toggleExternal(true) result: ' + r);
                    },
                    function(e) {
                        alert('toggleExternal(true) error: ' + e);
                    }
                );
        };
        function onStopExternalClick() {
            window.plugins.sense.toggleExternal(false,
                    function(r) {
                        alert('toggleExternal(false) result: ' + r);
                    },
                    function(e) {
                        alert('toggleExternal(false) error: ' + e);
                    }
                );
        };
        function onAddDataPointClick() {
            window.plugins.sense.addDataPoint('pgsensor', 'PhoneGap sensor', 'PhoneGap', 'string', 'test', new Date().getTime(), 
                    function(r) {
                        alert('Data point stored. Result: ' + r);
                    },
                    function(e) {
                        alert('addDataPoint error: ' + e);
                    }
                );
        };
        function onGetLocalDataClick() {
            window.plugins.sense.getLocalData('pgsensor',
                    function(r) {
                        var output = '';
                        for (var i=0; i<r.length; i++) {
                            var dataPoint = r[i];
                            output += '\n' + i + ': ' + dataPoint['value'] + ' @' + dataPoint['timestamp'] + ';';
                        }
                        alert('\'pgsensor\' data: ' + output);
                    },
                    function(e) {
                        alert('getLocalData() error: ' + e);
                    }
                );
        };
        function onGetRemoteDataClick() {
            window.plugins.sense.getRemoteData('pgsensor', true,
                    function(r) {
                        var output = '';
                        for (var i=0; i<r.length; i++) {
                        var dataPoint = r[i];
                            output += '\n' + i + ': ' + dataPoint['value'] + ' @' + dataPoint['timestamp'] + ';';
                        }
                        alert('\'pgsensor\' data: ' + output);
                    },
                    function(e) {
                        alert('getRemoteData() error: ' + e);
                    }
                );
        };
        function onFlushBufferClick() {
            window.plugins.sense.flushBuffer(
                    function(r) {
                        alert('Data sent to CommonSense. Result: ' + r);
                    },
                    function(e) {
                        alert('flushBuffer() error: ' + e);
                    }
                );
        };
        function onGetStatusClick() {
            window.plugins.sense.getStatus(
                    function(r) {                        
                        var isRunning = (r && SensePlatform.STATUSCODE_RUNNING > 0);
                        var isLoggedIn = (r && SensePlatform.STATUSCODE_CONNECTED > 0);
                        var isSensingMotion = (r && SensePlatform.STATUSCODE_MOTION > 0);
                        var isSensingAmbience = (r && SensePlatform.STATUSCODE_AMBIENCE > 0);
                        if (isRunning && isLoggedIn) {
                            alert('Sense Platform is active');
                        } else if (!isLoggedIn) {
                            alert('Sense Platform is not logged in');
                        } else {
                            alert('Sense Platform is not running');
                        }
                        // etc
                    },
                    function(e) {
                        console.log('getStatus() error: ' + e);
                    }
                );
        };
        function onGetSessionIdClick() {
            window.plugins.sense.getSessionId(
                    function(r){
                        alert('getSessionId() result: ' + r);
                    },
                    function(e){
                        alert('getSessionId() error: ' + e);
                    }
                );
        };
        </script>
    </head>
                
    <body onload="onLoad();" id="stage" class="theme">
        <h1>Welcome to Sense's plugin!</h1>
        <h2>this file is located at assets/www/sense_platform.html</h2> 
        <a class="btn" onclick="onLoginClick();">Login as 'foo' / 'bar'</a>
        <a class="btn" onclick="onLogoutClick();">Log out</a>
        
        <a class="btn large" onclick="onRegisterClick();">Register user 'username'</a>
        
        <a class="btn" onclick="onStartSensingClick();">Start sensing</a>
        <a class="btn" onclick="onStopSensingClick();">Stop sensing</a>  
        
        <a class="btn small" onclick="onSampleClick(SensePlatform.SAMPLE_REALTIME);">Sample<br/>real time</a>  
        <a class="btn small" onclick="onSampleClick(SensePlatform.SAMPLE_OFTEN);">Sample<br/>often</a>  
        <a class="btn small" onclick="onSampleClick(SensePlatform.SAMPLE_NORMAL);">Sample<br/>normal</a>  
        <a class="btn small" onclick="onSampleClick(SensePlatform.SAMPLE_RARELY);">Sample<br/>rarely</a>  
        
        <a class="btn small" onclick="onSyncClick(SensePlatform.SYNC_REALTIME);">Sync<br/>real time</a>  
        <a class="btn small" onclick="onSyncClick(SensePlatform.SYNC_OFTEN);">Sync<br/>often</a>  
        <a class="btn small" onclick="onSyncClick(SensePlatform.SYNC_NORMAL);">Sync<br/>normal</a>  
        <a class="btn small" onclick="onSyncClick(SensePlatform.SYNC_ECO);">Sync<br/>rarely</a>  
        
        <a class="btn" onclick="onStartPhoneStateClick();">Start phone state sensors</a>        
        <a class="btn" onclick="onStopPhoneStateClick();">Stop phone state sensors</a>
        
        <a class="btn" onclick="onStartPositionClick();">Start position sensors</a> 
        <a class="btn" onclick="onStopPositionClick();">Stop position sensors</a>  
        
        <a class="btn" onclick="onStartAmbienceClick();">Start ambience sensors</a> 
        <a class="btn" onclick="onStopAmbienceClick();">Stop ambience sensors</a>  
        
        <a class="btn" onclick="onStartMotionClick();">Start motion sensors</a>
        <a class="btn" onclick="onStopMotionClick();">Stop motion sensors</a>
        
        <a class="btn" onclick="onStartNeighDevClick();">Start scanning devices</a>
        <a class="btn" onclick="onStopNeighDevClick();">Stop scanning devices</a>
        
        <a class="btn" onclick="onStartExternalClick();">Start external sensors</a>
        <a class="btn" onclick="onStopExternalClick();">Stop external sensors</a>
        
        <a class="btn large" onclick="onAddDataPointClick();">Add data point for 'pgsensor'</a>  
         
        <a class="btn" onclick="onGetLocalDataClick();">Get recent 'pgsensor' data from phone</a>            
        <a class="btn" onclick="onGetRemoteDataClick();">Get 'pgsensor' data from CommonSense</a>  
            
        <a class="btn large" onclick="onFlushBufferClick();">Flush sensor data buffer</a>  
            
        <a class="btn large" onclick="onGetStatusClick();">Get Sense status</a>
        
        <a class="btn large" onclick="onGetSessionIdClick();">Get CommonSense session ID</a>
    </body>
</html>
